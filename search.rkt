#lang rosette

(struct tree (left data right) #:transparent)

(define (first-half l)
  (define middle-index (floor (/ (length l) 2)))
  (take l middle-index))

(define (middle l)
  (define middle-index (floor (/ (length l) 2)))
  (cond [(empty? l) null]
        [else (list-ref l middle-index)]))

(define (second-half l)
  (define middle-index (+ 1 (floor (/ (length l) 2))))
  (cond [(< (length l) 2) null]
        [else (drop l middle-index)]))  

(define (from-sorted-list l)
  (cond [(empty? l) null]
        [else (tree (from-sorted-list (first-half l)) (middle l) (from-sorted-list (second-half l)))]))

(define (from-list l less-than)
  (from-sorted-list (sort (remove-duplicates l) less-than)))

(define (member? less-than t x)
  (cond [(empty? t) false]
        [(equal? x (tree-data t)) true]
        [(less-than x (tree-data t)) (member? less-than (tree-left t) x)]
        [else (member? less-than (tree-right t) x)]))

(define (build-sliding xs)
  (cond
    [(< (length xs) 3) (list)]
    [else (cons (take xs 3) (build-sliding (drop xs 1)))]))

(define example (list 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 12 4 24 25 26 27 3 28 29 30 31 3 8 32 33 3 1 21 34 35 36 37 38 39 40 14 41 42 43 12 1 44 3 1 45 46 17 47 48 20 49 3 50 51 52 53 17 54 55 1 56 57 58 59 60 61 17 62 63 64 65 66 67 12 27 68 69 35 70 71 1 72 3 1 73 74 1 75 76 77 78 35 79 80 81 82 14 83 1 84 69 85 3 86 87 88 89 90 35 91 92 93 94 95 37 20 96 97 38 98 99 74 100 3 86 101 102 103 14 104 105 3 1 106 107 104 108 109 69 110 111 112 113 1 114 35 115 65 47 20 116 117 3 118 119 20 77 120 121 122 123 124 125 3 126 69 127 3 128 74 1 129 3 1 130 131 132 133 134 135 136 69 137 138 86 139 140 69 141 142 143 86 144 135 3 20 145 146 147 20 148 69 149 150 151 74 152 69 153 133 154 135 155 69 86 156 47 19 3 20 157 158 159 3 1 160 161 133 162 163 164 165 47 20 166 69 167 168 14 19 169 3 170 171 17 172 173 174 38 175 176 177 178 86 102 179 50 35 91 180 181 69 182 19 1 183 19 184 177 91 27 185 1 186 3 20 187 53 188 189 1 190 191 192 35 193 194 195 196 17 197 177 198 93 199 200 90 201 202 189 35 203 204 47 205 206 69 17 47 207 208 12 209 19 35 210 211 212 213 20 214 195 210 35 215 14 216 217 218 219 65 220 221 222 135 74 109 1 75 223 224 225 226 210 227 3 228 50 221 35 229 230 231 17 172 232 177 92 93 233 234 235 71 236 86 237 238 14 20 239 3 240 241 69 242 243 69 37 244 35 91 92 245 246 247 71 1 248 37 249 17 196 211 250 251 17 252 86 11 253 254 65 255 256 19 35 210 257 258 69 259 14 260 261 3 1 96 262 1 263 69 19 35 210 257 264 265 47 266 267 1 268 269 3 270 74 83 35 47 271 272 12 1 273 3 86 103 274 275 253 35 47 264 276 14 277 35 91 211 278 3 279 37 280 65 281 74 256 93 282 20 283 69 48 284 12 285 286 287 35 288 20 289 290 291 1 292 287 17 293 177 294 20 283 291 1 295 3 38 296 12 1 285 297 298 175 69 17 299 69 300 20 301 3 302 303 304 305 37 19 306 8 32 210 20 307 50 308 309 310 291 20 311 312 1 313 69 274 314 3 38 315 316 14 1 317 3 318 17 319 35 47 207 320 14 321 17 322 323 324 4 325 65 255 326 37 4 96 19 327 328 329 330 12 177 35 331 326 12 332 333 3 86 334 69 35 335 326 20 336 12 20 337 14 1 338 83 339 14 86 340 341 326 17 91 342 86 26 343 69 199 344 345 83 35 210 326 346 347 12 348 192 74 349 350 351 17 210 352 93 1 244 17 172 232 177 185 38 353 119 14 1 354 291 1 355 3 1 311 312 1 356 74 86 357 358 192 12 1 359 360 361 14 362 17 229 37 1 96 19 35 47 363 364 17 365 366 19 35 47 14 1 367 368 3 1 369 20 370 132 371 34 164 17 210 203 40 185 38 315 372 1 30 3 373 374 17 375 17 376 20 377 185 177 378 326 12 379 12 177 37 380 17 210 67 257 86 381 382 1 383 384 3 385 69 386 17 387 12 388 74 86 389 17 390 37 1 289 391 282 20 392 185 86 393 291 1 394 3 395 396 374 69 221 17 397 1 398 60 12 399 326 192 12 8 9 35 400 19 327 17 47 20 401 3 1 402 35 210 199 264 403 404 93 405 1 8 210 257 406 407 408 164 409 19 264 394 267 1 410 411 12 94 412 413 414 199 415 4 404 196 211 416 417 50 17 418 192 12 86 290 360 419 360 420 386 19 17 421 332 333 3 1 422 69 3 86 423 17 406 1 410 424 210 425 109 426 74 1 427 428 429 69 430 431 432 14 86 289 433 434 410 435 1 21 273 436 74 1 437 3 1 438 83 35 439 210 257 440 441 221 35 442 324 443 444 445 35 446 358 447 448 14 1 449 74 1 357 450 451 1 452 80 1 453 3 1 454 69 221 35 455 326 1 456 204 457 324 326 19 204 47 1 458 314 287 17 210 232 177 291 81 217 459 74 86 357 460 14 461 12 1 462 463 135 464 465 3 466 291 1 438 69 74 1 467 3 20 427 468 1 469 470 419 471 20 472 3 473 185 474 475 476 231 14 1 340 17 477 1 338 69 478 1 479 3 1 480 14 83 35 210 255 326 17 91 342 38 481 482 135 14 261 483 484 50 17 172 485 279 12 486 315 487 360 488 360 17 47 489 65 490 19 17 491 86 422 12 305 205 492 69 19 35 27 493 14 94 494 495 496 20 497 83 35 498 210 210 499 69 500 360 17 501 502 47 54 503 434 345 504 324 326 19 17 505 506 197 19 4 47 507 192 42 360 35 508 168 14 509 327 510 133 511 47 193 14 512 20 513 19 17 47 12 514 1 515 516 93 517 52 221 1 518 47 12 519 520 133 521 345 435 12 4 11 83 17 47 12 522 523 69 524 42 360 17 406 525 93 526 527 195 47 17 12 528 529 479 251 530 253 164 86 531 532 10 533 282 1 534 287 86 422 440 535 33 19 1 536 537 33 538 74 20 539 540 541 542 543 83 544 27 477 545 185 1 546 547 264 548 549 550 551 552 17 553 1 260 554 555 434 556 3 1 557 558 29 559 291 560 561 532 562 563 17 564 29 565 566 567 532 568 569 570 571 572 573 291 560 574 532 575 576 185 1 577 578 17 579 1 580 581 582 69 583 584 585 586 587 588 532 562 74 589 590 591 291 560 592 532 593 12 1 594 595 596 597 598 599 600 601 107 602 556 603 532 604 605 606 607 14 608 609 610 14 1 611 612 6 1 613 614 615 616 617 618 93 619 620 17 621 586 622 623 14 1 577 624 625 626 627 20 628 629 434 630 3 619 631 632 633 12 634 635 636 634 12 594 637 638 1 260 639 640 585 38 186 178 20 641 642 17 643 294 198 93 586 587 644 644 644 644 644 644 645 17 646 192 586 587 14 1 647 3 648 649 650 651 324 1 652 653 1 30 654 3 1 655 656 17 210 657 658 434 98 60 659 69 660 74 326 93 661 662 17 663 664 665 666 17 667 20 264 98 668 669 98 17 670 211 671 672 17 667 20 673 674 675 50 17 676 677 678 17 172 365 212 360 217 679 195 670 17 55 216 680 681 682 360 17 544 683 17 172 67 257 20 684 20 60 3 282 685 17 686 687 360 17 196 688 253 69 689 690 69 53 17 691 19 17 676 692 291 693 694 19 199 695 17 696 697 1 698 473 185 83 343 33 464 699 17 670 211 250 700 17 329 701 702 17 424 172 703 704 69 667 440 705 50 53 17 172 1 75 706 3 204 360 13 424 172 365 707 69 204 33 678 3 4 708 3 702 17 709 19 17 667 386 710 3 38 711 712 678 3 4 713 17 172 714 12 715 716 1 717 3 1 718 719 3 38 103 69 3 38 531 17 676 720 1 721 17 544 180 238 716 722 14 1 22 3 94 723 724 3 725 20 726 3 1 10 727 19 728 326 274 1 729 253 19 38 407 422 730 731 14 94 260 732 17 172 365 255 4 733 195 696 734 60 197 4 11 251 164 17 172 735 122 93 736 17 250 19 1 737 738 739 26 211 18 249 204 676 740 69 386 17 670 211 741 742 743 267 1 744 1 745 69 1 746 69 747 247 360 20 748 749 221 17 667 50 341 1 750 751 83 199 695 752 26 753 672 1 754 83 17 755 324 756 69 1 757 83 17 544 238 716 14 4 758 26 467 14 94 759 760 3 1 761 3 110 762 763 761 12 764 50 464 765 761 12 766 29 767 33 768 769 17 667 770 227 360 8 771 32 3 772 638 1 773 3 1 774 775 17 406 347 776 3 430 777 778 779 780 69 20 781 782 14 1 783 784 3 94 785 83 464 765 786 1 787 3 20 788 83 210 789 74 1 790 3 1 791 792 793 69 74 38 180 794 3 795 796 797 17 714 12 798 38 513 12 1 799 69 800 12 801 38 802 803 14 20 804 93 805 17 36 806 20 283 258 14 807 74 808 809 810 8 811 812 813 3 814 107 135 815 816 93 817 14 1 317 3 818 164 819 820 69 821 226 822 1 823 24 824 825 826 19 110 827 828 210 657 829 830 424 47 20 259 831 267 832 833 19 226 210 834 122 20 835 779 836 3 837 14 20 838 122 839 840 272 110 841 47 842 14 1 843 226 844 19 314 3 256 505 845 12 846 847 1 848 849 69 845 74 20 850 851 3 84 852 12 798 1 520 272 813 47 853 74 1 854 360 54 360 74 1 855 856 3 259 226 714 19 204 91 27 857 93 177 12 858 1 859 444 47 860 19 17 47 12 861 716 110 862 178 1 863 864 3 529 742 865 267 199 866 867 553 395 868 869 813 69 17 870 86 871 291 120 3 110 872 69 873 326 874 35 875 86 876 69 877 716 1 878 80 1 879 880 83 881 1 30 882 3 86 883 434 394 3 884 885 220 886 806 104 260 887 137 69 888 17 421 197 177 69 86 289 889 890 891 892 513 716 1 878 80 1 879 69 104 274 1 394 17 91 893 894 895 3 279 360 896 897 20 898 186 90 442 192 324 20 899 900 29 315 901 3 813 47 282 839 14 1 902 360 35 70 1 903 3 1 904 291 1 905 906 3 1 907 908 909 95 501 17 910 12 911 912 880 1 913 69 47 207 208 12 209 839 289 914 14 282 1 75 290 17 210 315 232 38 401 69 86 120 889 915 17 667 211 916 12 917 918 50 1 689 17 919 12 920 347 19 104 47 54 74 830 69 19 1 914 17 210 232 291 86 921 135 922 90 102 923 1 924 17 47 925 12 926 927 928 226 210 70 1 656 226 210 211 232 20 929 930 69 226 931 932 519 933 14 1 934 69 135 935 12 936 1 100 226 210 174 3 1 937 938 3 275 939 940 19 135 941 12 942 1 943 944 892 945 14 946 69 947 3 948 949 950 83 951 71 892 952 953 830 17 954 47 54 955 956 957 94 958 959 960 50 17 961 210 962 69 643 93 253 382 1 963 14 1 964 69 17 965 19 86 966 135 307 178 20 950 3 967 968 969 970 17 421 971 1 972 464 973 956 974 347 74 38 120 975 976 69 20 977 17 978 120 979 3 980 282 326 69 981 38 982 876 877 716 1 921 983 267 813 14 1 984 272 985 360 17 471 986 899 114 17 987 38 988 71 20 989 69 990 991 287 1 992 993 994 773 324 995 17 425 1 996 287 217 997 998 81 3 999 482 135 1 997 3 1000 1001 839 3 1002 69 1 1003 210 257 1004 17 485 1005 994 1006 1007 1008 17 47 1009 12 1010 1 1011 3 1 1012 69 916 94 1013 12 1014 291 1 1015 3 1 1016 3 38 1017 672 17 210 1018 247 1019 1020 886 199 1021 98 1022 69 221 17 329 893 247 74 813 91 1023 20 77 1024 93 38 1025 1026 17 667 211 1027 12 1028 69 1 1029 3 20 368 3 1030 1031 204 1032 1033 1034 67 257 20 1035 3 1036 74 326 304 38 1037 83 1032 1038 93 1 1039 1040 324 326 267 839 1041 69 1 1042 69 1043 3 94 98 69 1044 1045 69 430 1046 1047 14 1048 1049 38 1050 1034 257 1051 819 20 306 1052 1053 1054 1 1055 47 1056 1057 93 326 12 1058 291 38 513 69 17 210 464 1059 14 1029 1 921 37 20 1060 1061 69 14 199 1062 37 20 1063 1064 994 282 1065 17 471 1 1066 1067 287 813 210 1068 12 1069 17 442 324 1 456 1070 437 204 1071 1072 74 464 1073 3 1074 257 1075 320 360 20 1069 17 47 1076 12 209 19 1 997 3 1 1077 1078 93 512 17 47 1079 710 896 505 1080 990 164 813 74 180 20 1081 1082 37 1 1067 93 1083 69 67 37 1 75 1084 3 1085 360 1086 17 47 1087 1079 19 1 1088 135 1089 69 19 896 331 12 1090 813 1091 93 1 1092 1093 3 1 1094 386 17 987 38 187 1095 37 20 823 1096 1097 1098 178 1099 19 17 91 893 247 74 1 1051 1100 1101 896 1102 1103 1104 1105 47 1106 1107 1108 267 1 1109 1110 3 120 1111 682 1112 3 766 17 965 19 813 91 1113 326 1079 327 1114 69 17 1115 987 38 187 12 86 1116 1085 247 1 127 69 1117 1118 1119 17 210 1120 1112 93 1121 20 392 90 689 205 1122 521 1123 221 1 921 1106 1124 1125 20 1126 494 1127 1128 1 1129 3 1 1130 17 210 735 1131 20 1132 1133 1134 42 1101 1135 1106 324 4 1136 1137 69 1 901 83 1138 38 144 151 326 74 1139 69 1140 434 289 1141 3 899 1142 47 949 74 959 1143 69 343 135 1144 909 20 778 1051 1145 1146 1147 199 1148 1128 1 1149 3 1 1069 1150 1151 47 386 1152 1153 12 4 996 3 1154 19 896 196 211 1155 417 69 17 1156 421 172 1157 186 71 1 1158 1159 3 1 1134 69 1160 38 1161 74 1162 1163 434 1164 1165 19 4 229 196 211 1166 12 326 251 1 1029 695 1167 216 1168 1169 12 20 862 12 1170 12 83 1 1171 3 4 1172 1173 674 1174 1175 766 17 670 211 18 19 17 667 1160 3 1 1176 83 1177 1178 1179 14 104 3 1 1180 3 1181 19 38 1182 1183 172 1184 326 237 12 237 74 702 17 676 1185 20 1186 314 287 216 1187 1188 12 19 17 1189 1190 12 326 251 819 233 1191 29 739 33 1192 386 1193 19 17 667 1194 1009 71 1 1195 3 1196 205 1197 12 1198 1199 1200 1201 19 1032 1080 17 172 365 1202 19 1203 33 211 1204 74 766 6 4 1205 17 220 3 1206 1087 19 813 47 1 1149 3 1207 50 1208 17 229 90 1209 30 17 670 211 1210 50 496 94 1211 185 1 1212 1 1213 191 324 38 1214 17 210 1215 192 38 976 69 47 1216 716 324 1 515 785 3 1217 1218 1219 69 1220 37 1 1221 3 38 1222 1223 17 421 211 172 1224 770 1225 93 1 1051 679 710 267 1226 416 19 211 924 1227 20 1228 3 1229 47 324 1002 1157 69 1230 14 948 1231 93 892 1232 1233 69 1234 434 1214 83 892 418 1235 1236 151 326 74 1237 69 74 1238 1239 1 137 1240 3 1 260 1055 730 830 86 422 112 1241 74 1 929 1242 3 1 1243 569 35 47 1244 407 17 421 211 50 27 1245 69 53 17 91 172 1246 86 422 185 1247 37 1 1248 3 1 1089 360 419 360 17 91 172 1246 1 60 230 185 531 1249 773 12 177 17 471 716 185 1 1250 69 1251 86 1252 1253 651 177 247 880 1 1254 3 38 1255 532 1256 911 710 326 19 12 845 267 1 513 17 210 379 91 27 689 1257 1227 12 1258 880 1 1259 1260 1261 1262 12 38 1263 1264 17 1160 20 1265 93 1 44 12 1 1266 83 17 421 1267 291 1 682 906 3 1 1136 1268 434 1269 210 267 4 96 425 19 17 47 231 69 17 47 1224 74 1270 1233 69 1271 1272 434 277 19 204 33 1117 12 1273 328 50 1274 1275 267 1276 19 896 135 1277 267 1 1226 69 1278 1279 3 38 1280 69 19 17 47 20 1281 1005 1282 1283 1246 326 185 1 1284 1285 1286 3 1 1287 69 1288 326 12 1289 1 903 3 1 1290 1291 1101 94 1292 1293 421 27 1294 29 187 47 1295 1296 1297 360 17 965 19 17 210 1144 924 757 3 1 1298 1299 3 1 921 12 1 1266 1227 1300 69 245 204 910 19 35 70 20 1301 83 881 12 1 1129 3 1 904 69 211 12 1 1266 83 17 210 1302 91 348 326 12 1 913 69 12 1163 444 33 1303 1165 19 12 4 277 17 1304 38 103 69 1 24 1305 69 1306 83 728 326 274 1 1029 729 202 29 30 757 19 17 47 291 1 1307 921 442 221 17 174 1 1308 3 1 1077 1309 1106 1310 1311 69 1311 682 235 12 38 1312 17 965 48 19 896 210 735 12 1 193 3 1 1313 1314 1315 37 1 453 3 1 1259 12 1 1169 3 83 38 187 210 1316 326 69 1 422 3 999 17 651 1317 291 20 289 899 1318 312 1 921 1319 69 12 38 1320 69 1321 1 950 3 1077 1309 1322 1147 1 996 3 20 1323 1324 17 965 1 1269 91 985 1325 19 896 135 291 1 1307 921 69 19 1 804 93 326 91 27 1326 14 1 1169 1231 360 985 360 896 822 38 1327 17 210 1328 50 20 1108 1329 521 221 249 66 12 27 94 1330 921 477 247 1147 1 237 3 20 1331 1332 434 921 47 899 69 1333 125 69 881 1334 69 14 1 302 1231 17 331 12 1335 434 1336 1337 93 430 777 1338 291 38 1339 69 291 38 193 47 94 1340 69 806 1341 1342 12 1 1343 3 20 1344 1345 17 210 485 4 921 93 1121 20 777 1346 221 20 1347 1348 12 1 1169 1349 326 12 1 1350 3 20 1351 732 434 44 47 282 1352 1338 14 1353 69 839 12 1352 1338 1354 69 37 4 44 1 921 1355 444 47 1079 1356 956 74 1 1357 1358 3 1359 83 33 20 1360 1361 3 1362 204 210 519 409 1363 205 1364 1365 17 493 813 324 1 1366 50 1 823 1367 1368 1369 12 1370 1 1371 1372 3 1373 17 1009 1066 185 38 1374 1375 86 407 1376 1377 86 237 69 1378 86 1379 1380 122 177 1381 93 1 770 261 3 94 95 14 1 237 3 1 277 19 17 965 177 12 27 1382 17 47 264 1383 3 1384 35 47 1385 20 60 14 948 1386 20 1387 158 1388 20 1389 69 1390 1391 69 204 47 74 20 1392 3 1 1393 1394 19 17 1395 335 247 38 842 1396 37 1397 1398 884 422 287 204 730 291 1 1399 17 1400 71 1 1401 12 1402 17 406 20 1351 1403 674 20 777 1338 14 1404 69 1405 90 688 1338 14 1406 20 1407 69 1408 1409 69 819 217 1410 19 1 1401 931 37 199 863 1411 257 1412 434 186 3 1 1401 47 386 1413 14 1414 1415 19 17 421 211 1267 1208 343 135 1416 71 217 1417 90 1418 272 17 47 1419 38 1368 17 1420 12 691 20 1421 1422 1423 122 326 83 17 1424 12 1 1425 3 38 1426 69 1427 1428 69 1 1429 185 1 1430 3 1 1431 69 1 1432 17 1433 986 338 14 38 1434 1299 360 17 965 19 314 60 421 1435 1 921 12 1 1401 178 94 1436 17 985 1437 386 1438 19 17 421 1439 1440 1 148 1441 12 1442 347 291 1 653 3 1 1401 93 20 21 1443 1444 50 17 965 19 4 91 365 1445 360 204 91 1446 1447 473 37 1 1248 3 38 1051 1448 424 1173 27 324 326 37 216 1449 585 94 1450 17 877 80 1 44 3 1 1401 180 12 1451 1452 178 20 906 1453 69 185 343 1454 1027 324 1 1455))

(define (make-example-sliding)
  example-sliding)

(define (list-less-than x y)
  (cond [(and (empty? x) (empty? y)) false]
        [(empty? x) true]
        [(empty? y) false]
        [(not (equal? (car x) (car y))) (< (car x) (car y))]
        [else (list-less-than (cdr x) (cdr y))]))

(define example-sliding (from-list (build-sliding example) list-less-than))

(define (tree-member? x t)
  (member? list-less-than t x))

(define-symbolic a b c d e f g h i integer?)

(define (check l)
  (for-each (λ (x) (assert (tree-member? x l))) (list (list a b c) (list d e f) (list g h i) (list a d g) (list b e h) (list c f i)))
  (for-each (λ (x) (assert (not (equal? (car x) (second x))))) (list (list b d) (list c e) (list e g) (list f h))))

(define sol (solve (check example-sliding)))

(define answer (evaluate (list a b c d e f g h i) sol))
answer
